<!DOCTYPE html>
<html>
  <head>
      <title></title>
      <link rel="stylesheet" href="styles/kendo.common.min.css" />
      <link rel="stylesheet" href="styles/kendo.default.min.css" />
      <link rel="stylesheet" href="styles/kendo.mobile.all.min.css" />

      <script src="js/jquery.min.js"></script>
      <script src="js/kendo.all.min.js"></script>    
  </head>
  
  <body>

    <div data-role="view" data-init="initData"  data-title="進行量測" style="font-family:'Noto Sans TC';" data-use-native-scrolling="true" data-show="kendoViewReady" >

      <div data-role="content" style="background-image: url('ForgeLogo.png'); 
                                  background-repeat: no-repeat; 
                                  background-position: bottom;
                                  background-color: black;
                                  "> 

        <p style="font-size:18px; color: white; margin:20px">1. 請選擇 身體組成分析儀 所在的健身房</p>

        <div id="店面">
<!--
          <a class="" style="font-size: 18px; color: white; background-color:red; padding:10px;border-radius:8px" onclick="selectStore(0)">永和店</a> 
          <a class="" style="font-size: 18px; color: white; background-color:gray; padding:10px;border-radius:8px" onclick="">板橋店</a> 
-->
        </div>           

        <p style="font-size:18px; color: white; margin:20px; margin-top: 50px">2. 請按下按鈕，送出測量要求</p>      
        <div style="height: 20px"></div>
        <div style="text-align: center">
        <a class="" style="font-size: 18px; color: white; background-color:red; padding:10px;border-radius:8px" onclick="送出要求測量()">要求測量</a> 
        </div>       
       
        <p style="font-size:18px; color: white; margin:20px; margin-top: 50px">3. 請到 身體組成分析儀 上, 進行測量</p>       

        <div style="height: 20px"></div>
        <div style="text-align: center">
        <a class="" style="font-size: 18px; color: white; background-color:red; padding:10px;border-radius:8px" onclick="app.navigate('2-views/量測報告-now.html?reportId=')">查看報告</a> 
        </div>
        <p id="測量訊息" style="font-size:18px; color: white; margin:20px">量測中 ...</p>               
      </div>     
    </div>
    
    <script>
      var 店面名稱=["永和店", "板橋店", "土城店", "錦州店",
                   "三重店", "松山店", "府中店", "未來店",
                   "未來店"                 
                  ]; // 測試用，之後從 API 取得

      var 機器序號=["T00000001", "T00000002", "T00000003", "T00000004",
                   "T00000005", "T00000006", "T00000007", "T00000008",
                   "T00000009"                 
                  ]; // 測試用，之後從 API 取得      
      
      var 上次使用店面編號 = localStorage.getItem("上次使用店面編號") || 0; // if null then 0
      var selectedStoreNum = 上次使用店面編號;
      
      function kendoViewReady() {
        console.log( "ready!" );
        
        for (var i=0; i<店面名稱.length;i++) {
          
          var 按鈕顏色 = (i==上次使用店面編號)?"red":"gray";
          // 店面 0, 4, 8, 12, ...
          if (i%4 == 0 || i%4 == 1 || i%4 == 2) {
            var storeToadd = '<a id="'+"店面"+i.toString()+'" style="margin-left:20px;font-size: 18px; color: white; background-color:'+按鈕顏色+'; padding:10px;border-radius:8px" onclick="selectStore('+i.toString()+')">'+店面名稱[i]+'</a>';
            console.log(storeToadd);
            $("#店面").append(storeToadd);        
          } else { // 店面 1,2,5,6
            var storeToadd = '<a id="'+"店面"+i.toString()+'" style="margin-left:20px;font-size: 18px; color: white; background-color:'+按鈕顏色+'; padding:10px;border-radius:8px" onclick="selectStore('+i.toString()+')">'+店面名稱[i]+'</a>';
            $("#店面").append(storeToadd);      
            $("#店面").append("<br><br><br>");             
          }  
        }
      };
      
      function selectStore(storeNumber){
        console.log("selectStore", storeNumber);
        selectedStoreNum = storeNumber;
        for (var i=0; i<店面名稱.length;i++) {
          if (i==storeNumber) {
            $("#店面"+i.toString()).css("background-color", "red");
          } else {
            $("#店面"+i.toString()).css("background-color", "gray");
          }
        } 
      }
      
      function 送出要求測量(){
        console.log("送出要求測量", selectedStoreNum, 機器序號[selectedStoreNum]);
        confirm("為了您的權益，請檢查是在打鐵健身 "+店面名稱[selectedStoreNum]+" 身體組成分析儀 序號:"+機器序號[selectedStoreNum]+"上進行量測。\n\n序號可在機器上查對");
              
      
    </script>
    
    <script>
      //以下必須 remark 掉，不然會有問題
      //var app = new kendo.mobile.Application(document.body, { skin: "nova" });
    </script>

  </body>
</html>